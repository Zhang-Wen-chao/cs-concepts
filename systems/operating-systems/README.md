# Operating Systems - æ“ä½œç³»ç»Ÿ

> ç®¡ç†è®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶èµ„æºçš„æ ¸å¿ƒç³»ç»Ÿè½¯ä»¶

## ğŸ¯ ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ

**æ“ä½œç³»ç»Ÿ (OS)** æ˜¯ç®¡ç†è®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶èµ„æºçš„ç³»ç»Ÿè½¯ä»¶ï¼Œä¸ºåº”ç”¨ç¨‹åºæä¾›æœåŠ¡ã€‚

### ç±»æ¯”ç†è§£

**æ“ä½œç³»ç»Ÿå°±åƒä¸€ä¸ªå…¬å¸çš„æ€»ç»ç†**ï¼š
- **ç®¡ç†èµ„æº** - åˆ†é…CPUã€å†…å­˜ã€ç¡¬ç›˜ç­‰ç¡¬ä»¶èµ„æº
- **åè°ƒå·¥ä½œ** - è®©å¤šä¸ªç¨‹åºåŒæ—¶è¿è¡Œäº’ä¸å¹²æ‰°
- **æä¾›æœåŠ¡** - ä¸ºåº”ç”¨ç¨‹åºæä¾›æ–‡ä»¶ç®¡ç†ã€ç½‘ç»œé€šä¿¡ç­‰åŠŸèƒ½
- **ä¿æŠ¤å®‰å…¨** - é˜²æ­¢ç¨‹åºäº’ç›¸å¹²æ‰°å’Œæ¶æ„æ”»å‡»

---

## ğŸ—ï¸ æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½

### 1. è¿›ç¨‹ç®¡ç† (Process Management)
- åˆ›å»ºã€è°ƒåº¦ã€ç»ˆæ­¢è¿›ç¨‹
- è¿›ç¨‹é—´é€šä¿¡
- è¿›ç¨‹åŒæ­¥ä¸äº’æ–¥
- æ­»é”å¤„ç†

### 2. å†…å­˜ç®¡ç† (Memory Management)
- å†…å­˜åˆ†é…ä¸å›æ”¶
- è™šæ‹Ÿå†…å­˜
- åˆ†é¡µä¸åˆ†æ®µ
- å†…å­˜ä¿æŠ¤

### 3. æ–‡ä»¶ç³»ç»Ÿ (File System)
- æ–‡ä»¶çš„ç»„ç»‡ã€å­˜å‚¨ã€æ£€ç´¢
- ç›®å½•ç®¡ç†
- æ–‡ä»¶æƒé™ä¸å®‰å…¨
- ç£ç›˜ç©ºé—´ç®¡ç†

### 4. I/Oç®¡ç† (I/O Management)
- è®¾å¤‡é©±åŠ¨ç¨‹åº
- ç¼“å†²ä¸ç¼“å­˜
- ä¸­æ–­å¤„ç†
- ç£ç›˜è°ƒåº¦

### 5. ç½‘ç»œç®¡ç†
- ç½‘ç»œåè®®æ ˆ
- Socketé€šä¿¡
- ç½‘ç»œèµ„æºç®¡ç†

---

## ğŸ“š å­¦ä¹ è·¯å¾„

### æ ¸å¿ƒæ¦‚å¿µï¼ˆæ¨èé¡ºåºï¼‰

1. **[è¿›ç¨‹ä¸çº¿ç¨‹](processes-threads.md)** â­â­â­
   - è¿›ç¨‹çš„æ¦‚å¿µ
   - çº¿ç¨‹çš„æ¦‚å¿µ
   - è¿›ç¨‹è°ƒåº¦ç®—æ³•
   - ä¸Šä¸‹æ–‡åˆ‡æ¢

2. **[è¿›ç¨‹åŒæ­¥ä¸äº’æ–¥](synchronization.md)** â­â­â­
   - ä¸´ç•ŒåŒºé—®é¢˜
   - äº’æ–¥é”ã€ä¿¡å·é‡
   - æ­»é”çš„æ¦‚å¿µå’Œå¤„ç†
   - ç»å…¸åŒæ­¥é—®é¢˜

3. **[å†…å­˜ç®¡ç†](memory-management.md)** â­â­â­
   - ç‰©ç†å†…å­˜ä¸è™šæ‹Ÿå†…å­˜
   - åˆ†é¡µä¸åˆ†æ®µ
   - é¡µé¢ç½®æ¢ç®—æ³•
   - å†…å­˜åˆ†é…ç­–ç•¥

4. **[æ–‡ä»¶ç³»ç»Ÿ](file-systems.md)** â­â­
   - æ–‡ä»¶çš„ç»„ç»‡æ–¹å¼
   - ç›®å½•ç»“æ„
   - ç£ç›˜ç®¡ç†
   - æ–‡ä»¶ç³»ç»Ÿç±»å‹

5. **[I/Oç³»ç»Ÿ](io-systems.md)** â­â­
   - I/Oè®¾å¤‡åˆ†ç±»
   - I/Oæ§åˆ¶æ–¹å¼
   - ç¼“å†²æŠ€æœ¯
   - ç£ç›˜è°ƒåº¦

---

## ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ

### è¿›ç¨‹ vs çº¿ç¨‹

```
è¿›ç¨‹ (Process)
- èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½
- æ‹¥æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´
- è¿›ç¨‹é—´é€šä¿¡å¼€é”€å¤§
- ä¾‹å­ï¼šæ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨

çº¿ç¨‹ (Thread)
- CPUè°ƒåº¦çš„åŸºæœ¬å•ä½
- å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´
- çº¿ç¨‹é—´é€šä¿¡å¼€é”€å°
- ä¾‹å­ï¼šæµè§ˆå™¨ä¸­çš„å¤šä¸ªæ ‡ç­¾é¡µ
```

### è¿›ç¨‹çŠ¶æ€

```
        åˆ›å»º
         â†“
    [æ–°å»º New]
         â†“
    [å°±ç»ª Ready] â†â†’ [è¿è¡Œ Running]
         â†‘              â†“
         â””â”€â”€â”€ [é˜»å¡ Blocked]
                   â†“
              [ç»ˆæ­¢ Terminated]
```

### è°ƒåº¦ç®—æ³•å¯¹æ¯”

| ç®—æ³• | ç‰¹ç‚¹ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|-----|------|------|------|
| **FCFS** | å…ˆæ¥å…ˆæœåŠ¡ | ç®€å• | çŸ­ä½œä¸šç­‰å¾…é•¿ |
| **SJF** | çŸ­ä½œä¸šä¼˜å…ˆ | å¹³å‡ç­‰å¾…çŸ­ | é•¿ä½œä¸šé¥¥é¥¿ |
| **RR** | æ—¶é—´ç‰‡è½®è½¬ | å“åº”å¿« | ä¸Šä¸‹æ–‡åˆ‡æ¢å¤š |
| **ä¼˜å…ˆçº§** | æŒ‰ä¼˜å…ˆçº§ | çµæ´» | å¯èƒ½é¥¥é¥¿ |

### å†…å­˜ç®¡ç†æŠ€æœ¯

```
ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨ï¼Ÿ
    â†“
è™šæ‹Ÿå†…å­˜æŠ€æœ¯
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¨‹åºçœ‹åˆ°çš„åœ°å€   â”‚ (è™šæ‹Ÿåœ°å€)
â”‚  0x00001000      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ MMUè½¬æ¢
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®é™…ç‰©ç†åœ°å€     â”‚ (ç‰©ç†åœ°å€)
â”‚  0x12345000      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
å¯ä»¥æ˜ å°„åˆ°ç£ç›˜ (Swap)
```

---

## ğŸ–¥ï¸ å¸¸è§æ“ä½œç³»ç»Ÿ

### ç±»Unixç³»ç»Ÿ
- **Linux** - å¼€æºã€æœåŠ¡å™¨ä¸»æµ
- **macOS** - åŸºäºUnixã€ç”¨æˆ·å‹å¥½
- **BSD** - å­¦æœ¯ã€ç½‘ç»œ

### Windowsç³»åˆ—
- **Windows** - æ¡Œé¢ä¸»æµã€ä¼ä¸šåº”ç”¨

### ç§»åŠ¨ç³»ç»Ÿ
- **Android** - åŸºäºLinux
- **iOS** - åŸºäºUnix

### å®æ—¶ç³»ç»Ÿ
- **RTOS** - åµŒå…¥å¼ã€å·¥æ§

---

## ğŸ’¡ é‡è¦åŸç†

### 1. æ—¶é—´ç‰‡è½®è½¬
```python
# æ¨¡æ‹Ÿæ—¶é—´ç‰‡è½®è½¬è°ƒåº¦
from collections import deque

def round_robin(processes, time_quantum):
    """
    processes: [(pid, burst_time), ...]
    time_quantum: æ—¶é—´ç‰‡å¤§å°
    """
    queue = deque(processes)
    time = 0

    while queue:
        pid, burst = queue.popleft()

        if burst > time_quantum:
            # æ‰§è¡Œä¸€ä¸ªæ—¶é—´ç‰‡
            print(f"Time {time}: Process {pid} runs for {time_quantum}ms")
            time += time_quantum
            queue.append((pid, burst - time_quantum))
        else:
            # æ‰§è¡Œå®Œæ¯•
            print(f"Time {time}: Process {pid} runs for {burst}ms (finished)")
            time += burst

# ä½¿ç”¨
processes = [('P1', 10), ('P2', 5), ('P3', 8)]
round_robin(processes, time_quantum=4)
```

### 2. ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜
```python
from threading import Semaphore, Thread
from queue import Queue

buffer = Queue(maxsize=5)
empty = Semaphore(5)  # ç©ºä½æ•°é‡
full = Semaphore(0)   # äº§å“æ•°é‡

def producer():
    for i in range(10):
        empty.acquire()  # ç­‰å¾…ç©ºä½
        buffer.put(i)
        print(f"Produced {i}")
        full.release()   # å¢åŠ äº§å“æ•°

def consumer():
    for i in range(10):
        full.acquire()   # ç­‰å¾…äº§å“
        item = buffer.get()
        print(f"Consumed {item}")
        empty.release()  # å¢åŠ ç©ºä½æ•°

# å¯åŠ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…
Thread(target=producer).start()
Thread(target=consumer).start()
```

### 3. é¡µé¢ç½®æ¢ç®—æ³•
```python
def fifo_page_replacement(pages, frame_count):
    """FIFOé¡µé¢ç½®æ¢ç®—æ³•"""
    frames = []
    page_faults = 0

    for page in pages:
        if page not in frames:
            page_faults += 1
            if len(frames) < frame_count:
                frames.append(page)
            else:
                frames.pop(0)  # ç§»é™¤æœ€æ—©çš„
                frames.append(page)
            print(f"Page fault! Frames: {frames}")
        else:
            print(f"Page hit! Frames: {frames}")

    return page_faults

# ä½¿ç”¨
pages = [1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5]
faults = fifo_page_replacement(pages, frame_count=3)
print(f"Total page faults: {faults}")
```

---

## ğŸ”— ç›¸å…³æ¦‚å¿µ

- [å¹¶å‘ä¸å¹¶è¡Œ](../../fundamentals/programming-concepts/concurrency-parallelism.md) - å¤šçº¿ç¨‹ç¼–ç¨‹
- [å†…å­˜ç®¡ç†](../../fundamentals/programming-concepts/memory-management.md) - å†…å­˜åŸºç¡€
- [è¿›ç¨‹ä¸çº¿ç¨‹](processes-threads.md) - è¯¦ç»†è®²è§£

---

## ğŸ“– å­¦ä¹ å»ºè®®

### å…¥é—¨è·¯å¾„
1. å…ˆç†è§£è¿›ç¨‹å’Œçº¿ç¨‹çš„æ¦‚å¿µ
2. å­¦ä¹ è¿›ç¨‹è°ƒåº¦ç®—æ³•
3. ç†è§£å†…å­˜ç®¡ç†ï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰
4. å­¦ä¹ è¿›ç¨‹åŒæ­¥ï¼ˆé”ã€ä¿¡å·é‡ï¼‰
5. äº†è§£æ–‡ä»¶ç³»ç»ŸåŸºç¡€

### è¿›é˜¶å­¦ä¹ 
- é˜…è¯»æ“ä½œç³»ç»Ÿç»å…¸ä¹¦ç±ï¼ˆå¦‚ã€Šæ“ä½œç³»ç»Ÿæ¦‚å¿µã€‹ï¼‰
- åŠ¨æ‰‹å®è·µï¼šå†™å¤šçº¿ç¨‹ç¨‹åº
- ç ”ç©¶Linuxå†…æ ¸æºç 
- åšæ“ä½œç³»ç»Ÿå®éªŒï¼ˆå¦‚MIT 6.828ï¼‰

### å®è·µå»ºè®®
```bash
# Linuxä¸‹çš„å®ç”¨å‘½ä»¤

# æŸ¥çœ‹è¿›ç¨‹
ps aux
top / htop

# æŸ¥çœ‹å†…å­˜
free -h
vmstat

# æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿ
df -h
mount

# æŸ¥çœ‹I/O
iostat
lsof
```

---

**è®°ä½**ï¼š
1. æ“ä½œç³»ç»Ÿæ˜¯ç¡¬ä»¶å’Œåº”ç”¨ä¹‹é—´çš„æ¡¥æ¢
2. æ ¸å¿ƒåŠŸèƒ½ï¼šè¿›ç¨‹ç®¡ç†ã€å†…å­˜ç®¡ç†ã€æ–‡ä»¶ç³»ç»Ÿã€I/Oç®¡ç†
3. é‡ç‚¹ç†è§£ï¼šè¿›ç¨‹/çº¿ç¨‹ã€è°ƒåº¦ã€è™šæ‹Ÿå†…å­˜ã€åŒæ­¥
4. å®è·µå¾ˆé‡è¦ï¼šå†™å¤šçº¿ç¨‹ç¨‹åºï¼Œä½¿ç”¨Linuxå‘½ä»¤
5. æ“ä½œç³»ç»Ÿçš„è®¾è®¡å……æ»¡æƒè¡¡ï¼ˆtrade-offsï¼‰

**å¼€å§‹å­¦ä¹ æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µï¼** ğŸš€
